# 设备数据恢复指南

## 当前状态
- 已清除8个示例设备数据
- 保留了1个原始设备（ID: 1），但中文字符显示为乱码
- 需要从localStorage备份中恢复完整的原始数据

## 恢复步骤

### 方法1：从localStorage恢复数据

1. **打开前端页面**
   - 访问：http://localhost:3000
   - 使用管理员账户登录：
     - 用户名：admin
     - 密码：admin123

2. **检查localStorage数据**
   - 按F12打开开发者工具
   - 切换到Console标签
   - 输入以下命令检查数据：
   ```javascript
   // 检查原始设备数据
   console.log('原始设备数据:', localStorage.getItem('devices'));
   
   // 检查备份数据
   console.log('备份设备数据:', localStorage.getItem('devices_backup'));
   
   // 检查表头信息
   console.log('表头信息:', localStorage.getItem('tableHeaders'));
   
   // 检查迁移状态
   console.log('迁移日期:', localStorage.getItem('migration_date'));
   ```

3. **如果找到数据，使用前端迁移功能**
   - 如果localStorage中有数据，前端会自动显示数据迁移对话框
   - 点击"开始迁移"按钮
   - 等待迁移完成

4. **手动触发迁移（如果自动迁移未启动）**
   在Console中输入：
   ```javascript
   // 手动触发迁移检查
   window.location.reload();
   ```

### 方法2：手动导出和导入数据

1. **导出localStorage数据**
   在Console中输入：
   ```javascript
   // 导出设备数据为JSON
   const devicesData = localStorage.getItem('devices') || localStorage.getItem('devices_backup');
   if (devicesData) {
       const blob = new Blob([devicesData], {type: 'application/json'});
       const url = URL.createObjectURL(blob);
       const a = document.createElement('a');
       a.href = url;
       a.download = 'original_devices_backup.json';
       a.click();
       console.log('数据已导出为 original_devices_backup.json');
   } else {
       console.log('未找到设备数据');
   }
   ```

2. **使用批量导入功能**
   - 在设备管理页面，点击"导入"按钮
   - 选择导出的JSON文件
   - 确认导入

### 方法3：从Excel文件恢复

如果您有原始的Excel文件：
1. 在设备管理页面点击"导入"按钮
2. 选择Excel文件
3. 确认导入

## 数据格式说明

原始数据应包含以下字段：
- 名称
- 描述
- 状态
- 部门/位置
- 型号/规格
- 仪器设备编号
- 序列号/出厂编号
- 保管人
- 购买日期
- 校验有效期至

## 故障排除

### 如果localStorage中没有数据
1. 检查是否在其他浏览器中使用过系统
2. 检查浏览器是否清除过缓存
3. 联系系统管理员查看是否有数据库备份

### 如果迁移失败
1. 检查网络连接
2. 确认已登录管理员账户
3. 查看浏览器Console中的错误信息
4. 尝试刷新页面重新迁移

### 如果数据显示乱码
1. 确认文件编码为UTF-8
2. 检查数据库字符集设置
3. 重新导入数据时注意编码格式

## 联系支持

如果以上方法都无法恢复数据，请：
1. 保存localStorage中的所有数据
2. 记录具体的错误信息
3. 联系技术支持团队

---

**重要提示**：在进行任何数据操作前，建议先备份当前数据库文件 `lab_management.db`